<!DOCTYPE html>
<html lang="en" ng-app="harmonyApp">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmony High School</title>
    <!-- Tailwind CSS CDN for utility classes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- AngularJS CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <style>
        /* Custom styles for the image slideshow component */
        .image-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* Max width for the slideshow within the home section */
            aspect-ratio: 16 / 9; /* Maintain a consistent aspect ratio for images */
            overflow: hidden;
        }

        .image-container img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Cover the container without distortion */
            opacity: 0; /* Start hidden for transition effect */
            transition: opacity 1s ease-in-out; /* Smooth fade transition */
            border-radius: 1rem; /* Rounded corners for images */
        }

        .image-container img.active {
            opacity: 1; /* Make the active image visible */
        }

        /* General table styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0; /* Tailwind gray-200 */
        }
        th {
            background-color: #f8fafc; /* Tailwind gray-50 */
            font-weight: 600;
            color: #4a5568; /* Tailwind gray-700 */
            font-size: 0.875rem; /* text-sm */
            text-transform: uppercase;
        }
        tr:last-child td {
            border-bottom: none;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen font-sans text-gray-800" ng-controller="MainController">

    <!-- Header Section -->
    <header class="bg-blue-600 text-white p-4 shadow-md">
        <div class="container mx-auto flex justify-between items-center flex-wrap">
            <h1 class="text-2xl font-bold mb-2 md:mb-0">Harmony High School</h1>
            <nav class="w-full md:w-auto">
                <ul class="flex flex-wrap justify-center md:justify-end space-x-2 md:space-x-4">
                    <li><button ng-click="showSection('home')" class="px-3 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm md:text-base" ng-show="!loggedInRole">Home</button></li>
                    <li><button ng-click="showSection('about')" class="px-3 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm md:text-base" ng-show="!loggedInRole">About</button></li>
                    <li><button ng-click="showSection('contact')" class="px-3 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm md:text-base" ng-show="!loggedInRole">Contact</button></li>
                    <li><button ng-click="showSection('login')" class="px-3 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm md:text-base" ng-show="!loggedInRole">Login</button></li>
                    <!-- Logout button, shown when logged in -->
                    <li><button ng-click="logout()" class="px-3 py-2 rounded-md bg-red-500 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 text-sm md:text-base" ng-show="loggedInRole">Logout</button></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow container mx-auto p-4 py-8">
        <!-- Home Section -->
        <section id="home" ng-show="currentSection === 'home'" class="bg-white shadow-lg rounded-xl p-4 sm:p-6 mb-8">
            <h2 class="text-2xl sm:text-3xl lg:text-4xl font-extrabold text-center text-blue-700 mb-4 sm:mb-6">Welcome to Harmony High School</h2>
            <p class="text-base sm:text-lg text-gray-700 text-center mb-4 max-w-prose mx-auto">
                At Harmony High School, we believe that education is more than just academics—it's about cultivating character, inspiring creativity, and building a vibrant, inclusive community. Located in the heart of our town, we are proud to be a diverse and forward-thinking school where every student is empowered to thrive.
            </p>
            <p class="text-base sm:text-lg text-gray-700 text-center mb-6 sm:mb-8 max-w-prose mx-auto">
                We offer a dynamic curriculum, passionate educators, and a wide array of extracurricular opportunities designed to help students grow into confident, compassionate, and capable young adults. Whether you’re exploring the arts, diving into science and technology, or making a difference through student leadership, Harmony is a place where your potential meets possibility.
            </p>
            <p class="text-lg sm:text-xl font-semibold text-center text-blue-600 mb-6 sm:mb-8">
                Discover. Grow. Belong.
            </p>

            <!-- Image Slideshow Embedded within the Home Section -->
            <div class="image-slideshow-wrapper w-full max-w-xl md:max-w-2xl mx-auto">
                <h3 class="text-xl sm:text-2xl font-semibold text-center text-gray-700 mb-4">Our Featured Moments</h3>
                <div class="image-container mx-auto rounded-xl shadow-md">
                    <!-- Image 1 (Updated URL) -->
                    <img src="https://cdn.pixabay.com/photo/2020/01/22/09/39/teacher-4784916_1280.jpg" alt="Teacher with students" class="active"
                         onerror="this.onerror=null;this.src='https://placehold.co/800x450/cccccc/333333?text=Image+1+Not+Found';">
                    <!-- Image 2 -->
                    <img src="https://cdn.pixabay.com/photo/2017/07/31/09/52/basketball-2557076_1280.jpg" alt="Basketball player"
                         onerror="this.onerror=null;this.src='https://placehold.co/800x450/cccccc/333333?text=Image+2+Not+Found';">
                    <!-- Image 3 -->
                    <img src="https://cdn.pixabay.com/photo/2014/03/12/18/45/boys-286245_1280.jpg" alt="Boys playing"
                         onerror="this.onerror=null;this.src='https://placehold.co/800x450/cccccc/333333?text=Image+3+Not+Found';">
                    <!-- Image 4 -->
                    <img src="https://cdn.pixabay.com/photo/2021/09/28/20/42/kids-6665603_1280.jpg" alt="Kids playing outdoors"
                         onerror="this.onerror=null;this.src='https://placehold.co/800x450/cccccc/333333?text=Image+4+Not+Found';">
                </div>
            </div>

            <p class="text-sm sm:text-md text-gray-600 text-center mt-6 sm:mt-8 max-w-prose mx-auto">
                Welcome to your journey at Harmony High School.
            </p>
        </section>

        <!-- About Section -->
        <section id="about-section" ng-show="currentSection === 'about'" class="bg-white shadow-lg rounded-xl p-4 sm:p-6">
            <h2 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-4">About Us</h2>
            <h3 class="text-xl sm:text-2xl font-semibold text-gray-700 mb-2">Our Mission</h3>
            <p class="text-base text-gray-700 mb-3 sm:mb-4">
                Harmony High School is committed to providing a safe, supportive, and stimulating learning environment where students are encouraged to achieve academic excellence, embrace diversity, and become responsible global citizens.
            </p>
            <h3 class="text-xl sm:text-2xl font-semibold text-gray-700 mb-2">Our Vision</h3>
            <p class="text-base text-gray-700 mb-3 sm:mb-4">
                We envision a school where every student is known, valued, and challenged to reach their highest potential. Through a culture of respect, innovation, and collaboration, we prepare our students not just for college and careers—but for life.
            </p>
            <h3 class="text-xl sm:text-2xl font-semibold text-gray-700 mb-2">Who We Are</h3>
            <p class="text-base text-gray-700 mb-3 sm:mb-4">
                Founded on the principles of equity, integrity, and opportunity, Harmony High School serves a vibrant student body from diverse backgrounds. Our dedicated faculty and staff are passionate about fostering both intellectual and personal growth. We believe that when students feel seen, heard, and supported, they can accomplish great things.
            </p>
            <h3 class="text-xl sm:text-2xl font-semibold text-gray-700 mb-2">What Sets Us Apart</h3>
            <ul class="list-disc list-inside text-base text-gray-700 mb-3 sm:mb-4 pl-4">
                <li>Comprehensive academic programs including AP, honors, and career pathways</li>
                <li>Emphasis on arts, athletics, and community engagement</li>
                <li>Strong commitment to student wellness and social-emotional learning</li>
                <li>Safe, inclusive campus culture where all voices matter</li>
            </ul>
            <p class="text-base text-gray-700 text-center mt-4 sm:mt-6">
                Join us in building a future filled with promise, purpose, and Harmony.
            </p>
        </section>

        <!-- Contact Section -->
        <section id="contact-section" ng-show="currentSection === 'contact'" class="bg-white shadow-lg rounded-xl p-4 sm:p-6">
            <h2 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-4">Contact Us</h2>
            <p class="text-base text-gray-700 text-center">
                You can reach us at contact@example.com.
            </p>
        </section>

        <!-- Login Section -->
        <section id="login-section" ng-show="currentSection === 'login'" class="bg-white shadow-lg rounded-xl p-4 sm:p-6">
            <h2 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">Login</h2>
            <form ng-submit="login()" class="max-w-xs sm:max-w-md mx-auto">
                <div class="mb-4">
                    <label for="role" class="block text-gray-700 text-sm sm:text-base font-bold mb-2">Select Role:</label>
                    <select id="role" ng-model="loginData.role" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm sm:text-base">
                        <option value="">-- Please select a role --</option>
                        <option value="admin">Admin</option>
                        <option value="teacher">Teacher</option>
                        <option value="student">Student</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label for="username" class="block text-gray-700 text-sm sm:text-base font-bold mb-2">Username:</label>
                    <input type="text" id="username" ng-model="loginData.username" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm sm:text-base" placeholder="Enter your username">
                </div>
                <div class="mb-6">
                    <label for="password" class="block text-gray-700 text-sm sm:text-base font-bold mb-2">Password:</label>
                    <input type="password" id="password" ng-model="loginData.password" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline text-sm sm:text-base" placeholder="Enter your password">
                </div>
                <div class="flex items-center justify-between">
                    <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline text-sm sm:text-base">
                        Sign In
                    </button>
                    <a class="inline-block align-baseline font-bold text-xs sm:text-sm text-blue-500 hover:text-blue-800" href="#">
                        Forgot Password?
                    </a>
                </div>
                <div ng-show="loginMessage" class="mt-4 text-center text-red-500 text-sm sm:text-base">{{ loginMessage }}</div>
            </form>
        </section>

        <!-- Admin Dashboard -->
        <section id="admin-dashboard" ng-show="currentSection === 'admin-dashboard'" class="bg-white shadow-lg rounded-xl p-4 sm:p-6">
            <h2 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">Admin Dashboard</h2>
            <div class="text-center mb-6 flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-4">
                <button ng-click="showAdminSubSection('students')" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm sm:text-base">Manage Students</button>
                <button ng-click="showAdminSubSection('teachers')" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm sm:text-base">Manage Teachers</button>
            </div>

            <!-- Admin - Manage Students Section -->
            <div id="admin-students-management" ng-show="adminSubSection === 'students'">
                <h3 class="text-xl sm:text-2xl font-bold text-gray-700 mb-4">Manage Student Details</h3>
                
                <!-- Add/Update Student Form -->
                <form ng-submit="saveStudent()" class="mb-8 p-4 border rounded-md bg-gray-50">
                    <h4 class="text-lg sm:text-xl font-semibold mb-3">{{ editingStudent.id ? 'Edit Student' : 'Add New Student' }}</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="student-mgmt-name" class="block text-gray-700 text-sm font-bold mb-1">Name:</label>
                            <input type="text" id="student-mgmt-name" ng-model="editingStudent.name" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Student Name" required>
                        </div>
                        <div>
                            <label for="student-mgmt-age" class="block text-gray-700 text-sm font-bold mb-1">Age:</label>
                            <input type="number" id="student-mgmt-age" ng-model="editingStudent.age" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Student Age" required>
                        </div>
                        <div>
                            <label for="student-mgmt-class" class="block text-gray-700 text-sm font-bold mb-1">Class:</label>
                            <input type="text" id="student-mgmt-class" ng-model="editingStudent.class" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Class (e.g., 10th)" required>
                        </div>
                        <div>
                            <label for="student-mgmt-section" class="block text-gray-700 text-sm font-bold mb-1">Section:</label>
                            <input type="text" id="student-mgmt-section" ng-model="editingStudent.section" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Section (e.g., A)" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="student-mgmt-course" class="block text-gray-700 text-sm font-bold mb-1">Course:</label>
                            <input type="text" id="student-mgmt-course" ng-model="editingStudent.course" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Course (e.g., Science)" required>
                        </div>
                    </div>
                    <div class="flex justify-end">
                        <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-sm sm:text-base focus:outline-none focus:shadow-outline">Save Student</button>
                        <button type="button" ng-click="cancelEditStudent()" ng-show="editingStudent.id" class="ml-2 bg-gray-400 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded text-sm sm:text-base focus:outline-none focus:shadow-outline">Cancel</button>
                    </div>
                </form>

                <!-- Student List Table -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-md text-sm">
                        <thead>
                            <tr class="bg-gray-100 border-b">
                                <th class="py-2 px-4">Name</th>
                                <th class="py-2 px-4">Age</th>
                                <th class="py-2 px-4">Class</th>
                                <th class="py-2 px-4">Section</th>
                                <th class="py-2 px-4">Course</th>
                                <th class="py-2 px-4">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="student in students">
                                <td class="py-2 px-4">{{ student.name }}</td>
                                <td class="py-2 px-4">{{ student.age }}</td>
                                <td class="py-2 px-4">{{ student.class }}</td>
                                <td class="py-2 px-4">{{ student.section }}</td>
                                <td class="py-2 px-4">{{ student.course }}</td>
                                <td class="py-2 px-4">
                                    <button ng-click="editStudent(student)" class="bg-yellow-500 hover:bg-yellow-700 text-white text-sm py-1 px-2 rounded mr-2">Edit</button>
                                    <button ng-click="deleteStudent(student.id)" class="bg-red-500 hover:bg-red-700 text-white text-sm py-1 px-2 rounded">Delete</button>
                                </td>
                            </tr>
                            <tr ng-if="students.length === 0">
                                <td colspan="6" class="py-4 text-center text-gray-500">No students added yet.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Admin - Manage Teachers Section -->
            <div id="admin-teachers-management" ng-show="adminSubSection === 'teachers'">
                <h3 class="text-xl sm:text-2xl font-bold text-gray-700 mb-4">Manage Teacher Details</h3>
                
                <!-- Add/Update Teacher Form -->
                <form ng-submit="saveTeacher()" class="mb-8 p-4 border rounded-md bg-gray-50">
                    <h4 class="text-lg sm:text-xl font-semibold mb-3">{{ editingTeacher.id ? 'Edit Teacher' : 'Add New Teacher' }}</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="teacher-mgmt-name" class="block text-gray-700 text-sm font-bold mb-1">Name:</label>
                            <input type="text" id="teacher-mgmt-name" ng-model="editingTeacher.name" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Teacher Name" required>
                        </div>
                        <div>
                            <label for="teacher-mgmt-subject" class="block text-gray-700 text-sm font-bold mb-1">Subject:</label>
                            <input type="text" id="teacher-mgmt-subject" ng-model="editingTeacher.subject" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Subject Taught" required>
                        </div>
                        <div>
                            <label for="teacher-mgmt-experience" class="block text-gray-700 text-sm font-bold mb-1">Experience (Years):</label>
                            <input type="number" id="teacher-mgmt-experience" ng-model="editingTeacher.experience" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Years of Experience" required>
                        </div>
                        <div>
                            <label for="teacher-mgmt-qualification" class="block text-gray-700 text-sm font-bold mb-1">Qualification:</label>
                            <input type="text" id="teacher-mgmt-qualification" ng-model="editingTeacher.qualification" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Highest Qualification" required>
                        </div>
                        <div class="md:col-span-2">
                            <label for="teacher-mgmt-contact" class="block text-gray-700 text-sm font-bold mb-1">Contact:</label>
                            <input type="email" id="teacher-mgmt-contact" ng-model="editingTeacher.contact" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm" placeholder="Email or Phone" required>
                        </div>
                    </div>
                    <div class="flex justify-end">
                        <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-sm sm:text-base focus:outline-none focus:shadow-outline">Save Teacher</button>
                        <button type="button" ng-click="cancelEditTeacher()" ng-show="editingTeacher.id" class="ml-2 bg-gray-400 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded text-sm sm:text-base focus:outline-none focus:shadow-outline">Cancel</button>
                    </div>
                </form>

                <!-- Teacher List Table -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200 rounded-md text-sm">
                        <thead>
                            <tr class="bg-gray-100 border-b">
                                <th class="py-2 px-4">Name</th>
                                <th class="py-2 px-4">Subject</th>
                                <th class="py-2 px-4">Experience</th>
                                <th class="py-2 px-4">Qualification</th>
                                <th class="py-2 px-4">Contact</th>
                                <th class="py-2 px-4">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="teacher in teachers">
                                <td class="py-2 px-4">{{ teacher.name }}</td>
                                <td class="py-2 px-4">{{ teacher.subject }}</td>
                                <td class="py-2 px-4">{{ teacher.experience }}</td>
                                <td class="py-2 px-4">{{ teacher.qualification }}</td>
                                <td class="py-2 px-4">{{ teacher.contact }}</td>
                                <td class="py-2 px-4">
                                    <button ng-click="editTeacher(teacher)" class="bg-yellow-500 hover:bg-yellow-700 text-white text-sm py-1 px-2 rounded mr-2">Edit</button>
                                    <button ng-click="deleteTeacher(teacher.id)" class="bg-red-500 hover:bg-red-700 text-white text-sm py-1 px-2 rounded">Delete</button>
                                </td>
                            </tr>
                            <tr ng-if="teachers.length === 0">
                                <td colspan="6" class="py-4 text-center text-gray-500">No teachers added yet.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Teacher Dashboard -->
        <section id="teacher-dashboard" ng-show="currentSection === 'teacher-dashboard'" class="bg-white shadow-lg rounded-xl p-4 sm:p-6">
            <h2 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">Teacher Dashboard</h2>
            <p class="text-base text-gray-700 mb-4">Welcome, Teacher! Here are your students' details:</p>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-200 rounded-md text-sm">
                    <thead>
                        <tr class="bg-gray-100 border-b">
                            <th class="py-2 px-4 text-left text-sm font-semibold text-gray-600">Student Name</th>
                            <th class="py-2 px-4 text-left text-sm font-semibold text-gray-600">Class</th>
                            <th class="py-2 px-4 text-left text-sm font-semibold text-gray-600">Section</th>
                            <th class="py-2 px-4 text-left text-sm font-semibold text-gray-600">Course</th>
                            <th class="py-2 px-4 text-left text-sm font-semibold text-gray-600">Document</th>
                            <th class="py-2 px-4 text-left text-sm font-semibold text-gray-600">Grade</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="student in students">
                            <td class="py-2 px-4">{{ student.name }}</td>
                            <td class="py-2 px-4">{{ student.class }}</td>
                            <td class="py-2 px-4">{{ student.section }}</td>
                            <td class="py-2 px-4">{{ student.course }}</td>
                            <td class="py-2 px-4">
                                <button ng-if="student.document" class="bg-blue-500 hover:bg-blue-700 text-white text-sm py-1 px-2 rounded" ng-click="downloadDocument(student.document)">Download PDF</button>
                                <span ng-if="!student.document">N/A</span>
                            </td>
                            <td class="py-2 px-4">
                                <input type="text" ng-model="student.grade" class="w-20 border rounded px-2 py-1 text-sm" placeholder="Grade">
                            </td>
                        </tr>
                        <tr ng-if="students.length === 0">
                            <td colspan="6" class="py-4 text-center text-gray-500">No students to display.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="text-center mt-6">
                <button ng-click="submitGrades()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm sm:text-base focus:outline-none focus:shadow-outline">
                    Submit All Grades
                </button>
            </div>
            <div ng-show="teacherMessage" class="mt-4 text-center text-sm sm:text-base" ng-class="{'text-green-500': teacherMessageSuccess, 'text-red-500': !teacherMessageSuccess}">{{ teacherMessage }}</div>
        </section>

        <!-- Student Dashboard -->
        <section id="student-dashboard" ng-show="currentSection === 'student-dashboard'" class="bg-white shadow-lg rounded-xl p-4 sm:p-6">
            <h2 class="text-2xl sm:text-3xl font-bold text-center text-gray-800 mb-6">Student Dashboard</h2>
            <p class="text-base text-gray-700 mb-4">Welcome, Student! Update your details and upload documents here:</p>
            <form ng-submit="saveStudentDetails()" class="max-w-xs sm:max-w-md mx-auto">
                <div class="mb-4">
                    <label for="student-name-dash" class="block text-gray-700 text-sm sm:text-base font-bold mb-2">Name:</label>
                    <input type="text" id="student-name-dash" ng-model="currentStudentDetails.name" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm sm:text-base" placeholder="Your Full Name" required>
                </div>
                <div class="mb-4 flex flex-col sm:flex-row sm:space-x-4 space-y-4 sm:space-y-0">
                    <div class="w-full sm:w-1/2">
                        <label for="student-class-dash" class="block text-gray-700 text-sm sm:text-base font-bold mb-2">Class:</label>
                        <input type="text" id="student-class-dash" ng-model="currentStudentDetails.class" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm sm:text-base" placeholder="e.g., 10th" required>
                    </div>
                    <div class="w-full sm:w-1/2">
                        <label for="student-section-dash" class="block text-gray-700 text-sm sm:text-base font-bold mb-2">Section:</label>
                        <input type="text" id="student-section-dash" ng-model="currentStudentDetails.section" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm sm:text-base" placeholder="e.g., A" required>
                    </div>
                </div>
                <div class="mb-4">
                    <label for="student-course-dash" class="block text-gray-700 text-sm sm:text-base font-bold mb-2">Course:</label>
                    <input type="text" id="student-course-dash" ng-model="currentStudentDetails.course" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline text-sm sm:text-base" placeholder="e.g., Computer Science" required>
                </div>
                <div class="mb-6">
                    <label for="pdf-upload-dash" class="block w-full text-sm sm:text-base text-gray-700 font-bold mb-2">Upload Document (PDF):</label>
                    <!-- This input needs a directive for ng-model to work with files or plain JS -->
                    <input type="file" id="pdf-upload-dash" name="pdf-upload" accept=".pdf" onchange="angular.element(this).scope().setPdfFile(this.files[0])" class="block w-full text-sm sm:text-base text-gray-700
                        file:mr-4 file:py-2 file:px-4
                        file:rounded-full file:border-0
                        file:text-sm sm:file:text-base file:font-semibold
                        file:bg-blue-50 file:text-blue-700
                        hover:file:bg-blue-100">
                </div>
                <div class="flex items-center justify-center">
                    <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline text-sm sm:text-base">
                        Save Details
                    </button>
                </div>
                <div ng-show="studentDashboardMessage" class="mt-4 text-center text-sm sm:text-base" ng-class="{'text-green-500': studentDashboardMessageSuccess, 'text-red-500': !studentDashboardMessageSuccess}">{{ studentDashboardMessage }}</div>
            </form>
        </section>
    </main>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white p-4 mt-8">
        <div class="container mx-auto text-center text-sm sm:text-base">
            <p>&copy; 2025 Harmony High School. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // AngularJS Module and Controller
        angular.module('harmonyApp', [])
        .controller('MainController', ['$scope', '$timeout', function($scope, $timeout) {
            // --- Application State ---
            $scope.currentSection = 'home'; // Controls which main section is visible
            $scope.loggedInRole = null; // Stores 'admin', 'teacher', 'student', or null
            $scope.loginData = {}; // Data for the login form
            $scope.loginMessage = ''; // Message for login attempts

            $scope.adminSubSection = 'students'; // Controls 'students' or 'teachers' view in admin dashboard

            // Mock Data (In a real app, this would come from a backend/database)
            $scope.students = [
                { id: 1, name: 'John Doe', age: 16, class: '10th', section: 'A', course: 'Mathematics', document: 'john_math_hw.pdf', grade: '' },
                { id: 2, name: 'Jane Smith', age: 15, class: '9th', section: 'B', course: 'Science', document: 'jane_science_project.pdf', grade: '' },
                { id: 3, name: 'Mike Johnson', age: 17, class: '11th', section: 'C', course: 'History', document: 'mike_history_essay.pdf', grade: '' }
            ];
            $scope.teachers = [
                { id: 1, name: 'Mr. Davis', subject: 'Mathematics', experience: 10, qualification: 'M.Sc. Math', contact: 'davis@harmony.edu' },
                { id: 2, name: 'Ms. White', subject: 'Science', experience: 8, qualification: 'Ph.D. Biology', contact: 'white@harmony.edu' }
            ];

            $scope.editingStudent = {}; // Used for admin student edit form
            $scope.editingTeacher = {}; // Used for admin teacher edit form
            $scope.teacherMessage = ''; // Message for teacher dashboard actions
            $scope.teacherMessageSuccess = false;

            $scope.currentStudentDetails = {}; // Used for student dashboard form
            $scope.studentDashboardMessage = ''; // Message for student dashboard actions
            $scope.studentDashboardMessageSuccess = false;
            $scope.uploadedPdfFile = null; // For student PDF upload

            // --- Section Visibility Logic ---
            $scope.showSection = function(sectionName) {
                $scope.currentSection = sectionName;
                // If navigating to admin dashboard, default to students management
                if (sectionName === 'admin-dashboard') {
                    $scope.adminSubSection = 'students';
                }
                // If navigating to student dashboard, pre-fill current student details
                if (sectionName === 'student-dashboard') {
                    // Mocking for student with ID 1. In a real app, this would be the logged-in student.
                    const studentData = $scope.students.find(s => s.id === 1);
                    $scope.currentStudentDetails = studentData ? angular.copy(studentData) : {};
                }
            };

            // --- Login/Logout Logic ---
            $scope.login = function() {
                const { role, username, password } = $scope.loginData;
                $scope.loginMessage = ''; // Clear previous messages

                if (!role || !username || !password) {
                    $scope.loginMessage = 'Please fill in all fields.';
                    return;
                }

                let isAuthenticated = false;
                let dashboardSection = '';

                if (role === 'admin' && username === 'admin' && password === 'admin') {
                    isAuthenticated = true;
                    dashboardSection = 'admin-dashboard';
                } else if (role === 'teacher' && username === 'teacher' && password === 'teacher') {
                    isAuthenticated = true;
                    dashboardSection = 'teacher-dashboard';
                } else if (role === 'student' && username === 'student' && password === 'student') {
                    isAuthenticated = true;
                    dashboardSection = 'student-dashboard';
                }

                if (isAuthenticated) {
                    $scope.loggedInRole = role;
                    $scope.showSection(dashboardSection);
                    $scope.loginData = {}; // Clear form
                } else {
                    $scope.loginMessage = 'Invalid role, username, or password.';
                }
            };

            $scope.logout = function() {
                $scope.loggedInRole = null;
                $scope.showSection('home');
                $scope.loginData = {}; // Clear any lingering login form data
                $scope.loginMessage = ''; // Clear any login messages
                $scope.editingStudent = {}; // Clear admin form
                $scope.editingTeacher = {}; // Clear admin form
                $scope.teacherMessage = ''; // Clear teacher message
                $scope.studentDashboardMessage = ''; // Clear student message
                $scope.currentStudentDetails = {}; // Clear student dashboard form
                $scope.uploadedPdfFile = null;
            };

            // --- Admin Dashboard Functions ---
            $scope.showAdminSubSection = function(subSection) {
                $scope.adminSubSection = subSection;
                $scope.editingStudent = {}; // Clear edit state when switching
                $scope.editingTeacher = {}; // Clear edit state when switching
            };

            $scope.saveStudent = function() {
                if (!$scope.editingStudent.name || !$scope.editingStudent.age || !$scope.editingStudent.class || !$scope.editingStudent.section || !$scope.editingStudent.course) {
                    alert('Please fill in all student fields.'); // Use custom modal in production
                    return;
                }

                if ($scope.editingStudent.id) {
                    // Update existing student
                    const index = $scope.students.findIndex(s => s.id === $scope.editingStudent.id);
                    if (index !== -1) {
                        $scope.students[index] = angular.copy($scope.editingStudent);
                    }
                } else {
                    // Add new student
                    const newId = $scope.students.length > 0 ? Math.max(...$scope.students.map(s => s.id)) + 1 : 1;
                    const newStudent = angular.copy($scope.editingStudent);
                    newStudent.id = newId;
                    newStudent.document = ''; // Default for new student
                    newStudent.grade = ''; // Default for new student
                    $scope.students.push(newStudent);
                }
                $scope.editingStudent = {}; // Clear form after save
            };

            $scope.editStudent = function(student) {
                $scope.editingStudent = angular.copy(student); // Create a copy for editing
            };

            $scope.cancelEditStudent = function() {
                $scope.editingStudent = {}; // Clear the editing state
            };

            $scope.deleteStudent = function(id) {
                if (confirm('Are you sure you want to delete this student?')) { // Use custom modal in production
                    $scope.students = $scope.students.filter(s => s.id !== id);
                }
            };

            $scope.saveTeacher = function() {
                if (!$scope.editingTeacher.name || !$scope.editingTeacher.subject || !$scope.editingTeacher.experience || !$scope.editingTeacher.qualification || !$scope.editingTeacher.contact) {
                    alert('Please fill in all teacher fields.'); // Use custom modal in production
                    return;
                }

                if ($scope.editingTeacher.id) {
                    // Update existing teacher
                    const index = $scope.teachers.findIndex(t => t.id === $scope.editingTeacher.id);
                    if (index !== -1) {
                        $scope.teachers[index] = angular.copy($scope.editingTeacher);
                    }
                } else {
                    // Add new teacher
                    const newId = $scope.teachers.length > 0 ? Math.max(...$scope.teachers.map(t => t.id)) + 1 : 1;
                    const newTeacher = angular.copy($scope.editingTeacher);
                    newTeacher.id = newId;
                    $scope.teachers.push(newTeacher);
                }
                $scope.editingTeacher = {}; // Clear form after save
            };

            $scope.editTeacher = function(teacher) {
                $scope.editingTeacher = angular.copy(teacher); // Create a copy for editing
            };

            $scope.cancelEditTeacher = function() {
                $scope.editingTeacher = {}; // Clear the editing state
            };

            $scope.deleteTeacher = function(id) {
                if (confirm('Are you sure you want to delete this teacher?')) { // Use custom modal in production
                    $scope.teachers = $scope.teachers.filter(t => t.id !== id);
                }
            };

            // --- Teacher Dashboard Functions ---
            $scope.downloadDocument = function(docName) {
                alert(`Simulating download of: ${docName}`); // Replace with actual download logic
            };

            $scope.submitGrades = function() {
                let gradesUpdated = false;
                // In a real app, you'd send these updated grades to a backend
                // For now, we assume changes are already in $scope.students due to ng-model
                $scope.students.forEach(student => {
                    // Check if grade was actually changed (simple check)
                    // More robust check would involve comparing with initial state or a dirty flag
                    if (student.grade !== undefined && student.grade !== null && student.grade !== '') {
                        gradesUpdated = true;
                    }
                });

                if (gradesUpdated) {
                    $scope.teacherMessage = 'Grades submitted successfully!';
                    $scope.teacherMessageSuccess = true;
                } else {
                    $scope.teacherMessage = 'No grades were changed.';
                    $scope.teacherMessageSuccess = false;
                }
                $timeout(function() {
                    $scope.teacherMessage = '';
                }, 3000);
            };

            // --- Student Dashboard Functions ---
            $scope.setPdfFile = function(file) {
                $scope.uploadedPdfFile = file;
                // Manually trigger digest cycle if this function is called from outside Angular context
                if (!$scope.$$phase) {
                    $scope.$apply();
                }
            };

            $scope.saveStudentDetails = function() {
                const { name, class: studentClass, section, course } = $scope.currentStudentDetails;
                $scope.studentDashboardMessage = '';

                if (!name || !studentClass || !section || !course) {
                    $scope.studentDashboardMessage = 'Please fill in all required fields (Name, Class, Section, Course).';
                    $scope.studentDashboardMessageSuccess = false;
                    return;
                }

                // Simulate saving details for the current student (mocking for ID 1)
                const studentIndex = $scope.students.findIndex(s => s.id === 1);
                if (studentIndex !== -1) {
                    $scope.students[studentIndex].name = name;
                    $scope.students[studentIndex].class = studentClass;
                    $scope.students[studentIndex].section = section;
                    $scope.students[studentIndex].course = course;

                    if ($scope.uploadedPdfFile) {
                        $scope.students[studentIndex].document = $scope.uploadedPdfFile.name;
                        console.log(`Simulating PDF upload: ${$scope.uploadedPdfFile.name}`);
                        $scope.uploadedPdfFile = null; // Clear file input
                        document.getElementById('pdf-upload-dash').value = ''; // Clear file input visually
                    }
                    $scope.studentDashboardMessage = 'Student details saved successfully!';
                    $scope.studentDashboardMessageSuccess = true;
                } else {
                    $scope.studentDashboardMessage = 'Error: Could not find student to update.';
                    $scope.studentDashboardMessageSuccess = false;
                }

                $timeout(function() {
                    $scope.studentDashboardMessage = '';
                }, 3000);
            };

            // --- Image Slideshow (Vanilla JS - no Angular needed for this part) ---
            document.addEventListener('DOMContentLoaded', () => {
                const images = document.querySelectorAll('.image-container img');
                let currentImageIndex = 0;

                function showImage(index) {
                    images.forEach((img) => {
                        img.classList.remove('active');
                    });
                    images[index].classList.add('active');
                }

                function nextImage() {
                    currentImageIndex = (currentImageIndex + 1) % images.length;
                    showImage(currentImageIndex);
                }

                showImage(currentImageIndex);
                setInterval(nextImage, 5000);
            });

            // Initial setup - show home section on load
            $scope.showSection('home');
        }]);
    </script>
</body>
</html>
